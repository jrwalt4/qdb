/**
 * http://usejsdoc.org/
 */

function Person(name, job, age){};
var peopleList = [];

CDBM.setSchema('MyDB', {
	collections: [
		{
			name: 'people',
			keyPath: null, //use autogenerated
			indices: [
				{
					name: 'name-index',
					index: 'name',
					unique: false
				},
				{
					name: 'job-index',
					index: 'job',
					unique: false
				},
				{
					name: 'age-index',
					index: 'age',
					unique: false
				}
			]
		}
	]
});

CDBM.connect('MyDB', function(err, db) {
	db.collection('people').insertOne({
			name:'Reese',
			job: 'Engineer',
			age: 27
		}, function(err, result) {
			console.log(result);
		});
});

CDBM.connect('MyDB', function(err, db) {
	db.collection('people').insertMany(
		[{
			name:'Matt',
			job: 'Social Worker',
			age: 29
		},
		{
			name:'Anna',
			job: 'Social Worker',
			age: 28
		}], function(err, result) {
			console.log(result);
		});
});

CDBM.connect('MyDB', function(err, db) {
	var cursor = db.collection('people').find({
				$and:[	
					{name:{$eq: 'reese'}},
					{job:{$like: 'eng'}},
					{age:{$gt:20}}
				]});

	cursor.forEach(function(entry) {
		var person = new Person(entry.name, entry.job, entry.age);
		peopleList.push(person);
	});
});

CDBM.connect('MyDB', function(err, db) {
	db.collection('people').update({
			name:'Matt',
			job: 'Social Worker',
			age: 29
		}, function(err, result) {
			
		});
});